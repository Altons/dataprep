join with: Structure, flatten array & json col: customerkey = Structure, flatten array & json.customerkey, event_type = current_dataset.event_type, event_subtype_id = current_dataset.event_subtype_id, event_time = current_dataset.event_time, advertiser_id = current_dataset.advertiser_id, creative_id = current_dataset.creative_id, url = current_dataset.url, device_type = current_dataset.device_type, os_id = current_dataset.os_id, browser_id = current_dataset.browser_id, ip_address = current_dataset.ip_address, orderdate = Structure, flatten array & json.orderdate, customerfirstname = Structure, flatten array & json.customerfirstname, customerlastname = Structure, flatten array & json.customerlastname, customercity = Structure, flatten array & json.customercity, cusotmerstate = Structure, flatten array & json.cusotmerstate, customerzipcode = Structure, flatten array & json.customerzipcode, customercountry = Structure, flatten array & json.customercountry, totalsale = Structure, flatten array & json.totalsale, discount = Structure, flatten array & json.discount row: current_dataset.user_id == Structure, flatten array & json.customerkey type: inner
drop col: device_type, os_id, browser_id, ip_address, event_type, event_subtype_id action: Drop
settype col: event_time datetimeType: 'Datetime','mm-dd-yy hh:mm:ss','mm*dd*yy*HH:MM' type: Datetime
textformat col: customerlastname type: uppercase
extractpatterns type: custom col: url on: `{digit}+-{digit}+`
merge col: customerfirstname,customerlastname with: ' ' as: 'Full Name'
groupby group: customerkey value: AVERAGE(discount) type: flatAgg